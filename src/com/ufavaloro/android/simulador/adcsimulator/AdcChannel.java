package com.ufavaloro.android.simulador.adcsimulator;

public class AdcChannel {
	/**
	 * Channel Parameters
	 */
	// Sampling Period
	private double mTs;
	// Resolution in Bits
	private int mBits;
	// Total Resolution Steps
	private double mTotalSteps;
	// Resolution Step
	private double mStep;
	// Samples Array
	private short[] mSamples;
	// Samples to generate
	private int mTotalSamples = 0;
	// Iterator
	private int n = 0;
	// Value of the current Sample
	private short mCurrentSample = 0;
	// Delay (in mS) to generate mSamples (it depends on the Sampling Frequency and the
	// amount of Samples to generate
	private long mDelay;
	private double mSampling = 4;
	private int mTotalChannels;
	
	/**
	 * Signal Parameters
	 */
	// Signal Amplitude
	private double mA = 1;
	// Signal Frequency
	private double mF0 = 1;
	// Signal Offset (siempre tiene como base de continua mA)
	private double mOffset = 0;
	// Sawtooth slope
	private double mSawtoothSlope = 1;
	
	/**
	 * Signal Codes
	 */
	// Sine
	private final int SIGNAL_SINE = 1;
	
	// Sawtooth
	private final int SIGNAL_SAWTOOTH = 2;
	
	// Square
	private final int SIGNAL_SQUARE = 3;
	
	// Incrementing Sequence
	private final int SIGNAL_SEQUENCE = 4;
	
	// Human EKG Heartbeat
	// Already sampled and digitalized. 0-5v, 12 Bits, Fs ~ 1 kHz, 543 samples, ~ 120 bpm 
	private final int SIGNAL_EKG = 5;
	private CircularBuffer mEkgBuffer;
	private final short[] mEkgSignal = {381,
			384,
			387,
			390,
			393,
			396,
			399,
			403,
			407,
			411, 
			415,
			420,
			424,
			429,
			435,
			441,
			447,
			454,
			461,
			469, 
			477,
			485,
			495,
			504,
			515,
			526,
			537,
			549,
			562,
			575, 
			588,
			602,
			616,
			630,
			645,
			660,
			675,
			690,
			705,
			720, 
			734,
			749,
			763,
			776,
			789,
			801,
			813,
			823,
			833,
			842, 
			849,
			856,
			861,
			865,
			867,
			868,
			868,
			866,
			863,
			859,
			853,
			846,
			837,
			827,
			816,
			803,
			790,
			775,
			760,
			744, 
			728,
			710,
			693,
			675,
			657,
			639,
			622,
			604,
			588,
			571,
			556,
			541,
			527,
			514,
			502,
			491,
			481,
			473,
			465,
			459, 
			454,
			450,
			447,
			445,
			444,
			443,
			443,
			443,
			444,
			445,
			445,
			446,
			445,
			444,
			442,
			439,
			435,
			430,
			423,
			414,
			404,
			392,
			378,
			362,
			345,
			326,
			306,
			284,
			261,
			238,
			215,
			191,
			168,
			146,
			126,
			107,
			92,
			80,
			72,
			68,
			70,
			78,
			93,
			115,
			145,
			183,
			231,
			288,
			354,
			431,
			518,
			614,
			721,
			838,
			965,
			1101,
			1245,
			1396,
			1555,
			1720,
			1889,
			2062,
			2236,
			2412,
			2586,
			2759,
			2927,
			3089,
			3244,
			3391,
			3527,
			3651,
			3762,
			3859,
			3940,
			4005,
			4053,
			4083,
			4095,
			4088,
			4063,
			4020,
			3960,
			3882,
			3789,
			3680,
			3558,
			3423,
			3276,
			3120,
			2956,
			2785,
			2610,
			2431,
			2251,
			2071,
			1893,
			1718,
			1547,
			1382,
			1224,
			1074,
			932,
			800,
			677,
			565,
			463,
			372,
			292,
			222,
			162,
			113,
			73,
			43,
			21,
			6,
			0,
			0,
			5,
			16,
			32,
			51,
			73,
			98,
			125,
			152,
			181,
			210,
			238,
			266,
			292,
			318,
			342,
			364,
			384,
			402,
			418,
			432,
			443,
			453,
			461,
			467,
			471,
			473,
			474,
			473,
			472,
			469,
			466,
			461,
			456,
			451,
			446,
			440,
			435,
			429,
			424,
			419,
			414,
			410,
			406,
			403,
			400,
			398,
			396,
			395,
			394,
			394,
			394,
			395,
			396,
			397,
			399,
			401,
			403,
			405,
			408,
			410,
			413,
			415,
			418,
			420,
			423,
			425,
			427,
			429,
			431,
			433,
			434,
			436, 
			437,
			438,
			439,
			440,
			441,
			441,
			442,
			442,
			443,
			443,
			443,
			444,
			444,
			444,
			445,
			445,
			446,
			446,
			447,
			448,
			449,
			449,
			450,
			452,
			453,
			454,
			456,
			457,
			459,
			461,
			463,
			465,
			467,
			469,
			471,
			473,
			476,
			478,
			481,
			483,
			486,
			488,
			491,
			493,
			496,
			499,
			501,
			504,
			507,
			509,
			512,
			515,
			518,
			521,
			524,
			527,
			530,
			533,
			537,
			540,
			544,
			548,
			551,
			555,
			559,
			564,
			568,
			572,
			577,
			582,
			587,
			591,
			596,
			602,
			607,
			612,
			617,
			623,
			628,
			634,
			639,
			645,
			651,
			656,
			662,
			668,
			674,
			680,
			686,
			693,
			699,
			706,
			712,
			719,
			726,
			733,
			740,
			748,
			755,
			763,
			771,
			779,
			787,
			796,
			805,
			813,
			822,
			832,
			841,
			850,
			860,
			869,
			879,
			889,
			899,
			909,
			919,
			930,
			940,
			951,
			961,
			972,
			982,
			993,
			1004,
			1015,
			1026,
			1036,
			1047,
			1058,
			1070,
			1081,
			1092,
			1103,
			1114,
			1125,
			1136,
			1147,
			1157,
			1168,
			1178,
			1189,
			1199,
			1209,
			1219,
			1228,
			1237,
			1246,
			1254,
			1263,
			1270,
			1277,
			1284,
			1291,
			1296,
			1302,
			1306,
			1310,
			1314,
			1316,
			1318,
			1320,
			1320,
			1320,
			1319,
			1317,
			1315,
			1311,
			1307,
			1302,
			1296,
			1290,
			1282,
			1274,
			1264,
			1255,
			1244,
			1232,
			1220,
			1207,
			1193,
			1179,
			1164,
			1148,
			1132,
			1115,
			1098,
			1080,
			1063,
			1044,
			1026,
			1007,
			988,
			968,
			949,
			930,
			910,
			891,
			871,
			852,
			833,
			814,
			795,
			777,
			759,
			741,
			724,
			707,
			690,
			674,
			658,
			643,
			628,
			614,
			601,
			587,
			575,
			563,
			551,
			540,
			530,
			520,
			511,
			502,
			494,
			486,
			479,
			472,
			466,
			460,
			455,
			450,
			445,
			441,
			437,
			433,
			430,
			427,
			424,
			422,
			419,
			417,
			415,
			413,
			412,
			410,
			408,
			407,
			405,
			404,
			402,
			401,
			399,
			398,
			396,
			395,
			393,
			391,
			389,
			387,
			385,
			383,
			381};
	// Dog Aortic Pressure Wave (not digitalized, aprox. 50-120 mmHg, Fs: 250 Hz)
	private final int SIGNAL_PRESSURE = 6;
	private final double[] mPressureSignal = {70.25506592, 70.37869263, 69.38970947, 
											  69.88421631, 69.51333618, 69.88421631, 69.63696289, 
											  68.27713013, 68.89523315, 68.15350342, 68.02987671, 
											  67.41177368, 67.16455078, 67.53540039, 66.67007446, 
											  65.80471802, 66.29919434, 65.43383789, 64.81573486, 
											  65.06298828, 65.18661499, 64.93936157, 64.81573486,
											  65.18661499, 64.56851196, 64.07400513, 63.95040894, 
											  63.82678223, 64.69213867, 63.95040894, 63.57952881, 
											  63.82678223, 63.45590210, 63.33230591, 64.19763184, 
											  63.33230591, 63.20867920, 64.19763184, 63.33230591, 
											  63.08505249, 63.08505249, 62.83779907, 62.09606934, 
											  62.71420288, 61.60159302, 61.47796631, 61.23074341, 
											  60.73626709, 60.73626709, 59.50003052, 59.87091064, 
											  59.62365723, 59.50003052, 59.25280762, 58.38745117, 
											  59.00555420, 58.63470459, 59.12918091, 58.51107788, 
											  58.26382446, 57.76934814, 58.26382446, 58.51107788, 
											  58.63470459, 59.25280762, 59.12918091, 60.85986328, 
											  63.82678223, 69.76058960, 78.29043579, 86.20217896, 
											  91.14700317, 97.32806396, 102.2729187, 106.4760132, 
											  109.8137817, 111.4208679, 113.2751770, 115.1294861, 
											  116.8601990, 117.2310486, 118.3436279, 118.5908813, 
											  118.9617310, 119.2089844, 119.5798340, 119.8270874, 
											  119.7034607, 119.2089844, 118.5908813, 117.7255249, 
											  116.9837952, 116.1184692, 115.6239624, 115.2531128, 
											  114.1405334, 113.5224304, 112.2862244, 110.0610352, 
											  108.8248291, 106.8468933, 106.3523865, 104.8689575, 
											  103.6327515, 101.7784119, 99.67687988, 96.83358765,
											  92.87771606, 89.41632080, 90.03442383, 92.50683594, 
											  92.75408936, 91.88873291, 91.14700317, 91.27062988, 
											  91.39425659, 92.13598633, 92.13598633, 92.38323975,
			 								  92.50683594, 92.25961304, 93.00134277, 93.24856567, 
			 								  93.61944580, 94.23754883, 94.97927856, 95.22650146, 
			 								  95.35012817, 95.84460449, 95.84460449, 96.33911133, 
			 								  96.21548462, 96.46270752, 96.09185791, 95.84460449,
			 								  95.47375488, 94.97927856, 93.74307251, 94.23754883,
			 								  93.61944580, 92.63046265, 92.25961304, 91.76513672, 
			 								  91.51788330, 90.77615356, 89.91079712, 89.41632080,
			 								  88.42736816, 88.42736816, 87.43838501, 86.82028198,
			 								  86.20217896, 85.21319580, 84.84234619, 84.47149658,
			 								  84.22424316, 83.35888672, 82.49356079, 82.74078369, 
			 								  81.75183105, 81.62820435, 81.38095093, 80.63922119, 
			 								  80.51562500, 80.39199829, 80.02111816, 79.52664185, 
			 								  79.89752197, 78.78491211, 79.03216553, 78.78491211,
			 								  78.41406250, 78.29043579, 77.17785645, 77.17785645, 
			 								  76.31250000, 76.31250000, 76.18887329, 74.82904053, 
			 								  75.57077026, 74.82904053, 74.95266724, 74.33456421, 
			 								  73.59283447, 73.59283447, 73.09835815, 73.09835815, 
			 								  72.97473145, 72.72747803, 72.48025513, 72.97473145,
			 								  72.35662842, 72.72747803, 71.98574829, 72.23300171, 
			 								  72.10937500, 71.86215210, 71.61489868, 70.87316895,
			 								  71.49127197, 70.62594604, 70.74954224, 69.51333618,
			 								  69.76058960, 69.51333618, 68.77160645, 68.27713013, 
			 								  67.53540039, 67.41177368, 67.28817749, 66.67007446,
			 								  66.29919434, 66.17556763, 66.42282104, 66.05194092,
			 								  65.80471802, 66.17556763, 66.42282104, 65.92834473,
			 								  66.42282104, 65.92834473, 66.42282104};
	private final double mPressureMax = 119.8270874;
	private final double mPressureMin = 57.76934814;
	// Human CO2 Signal
	private final int SIGNAL_CO2 = 7;
	private final double[] mCo2Signal = {0.003,
			0.003,
			0.003,
			0.004,
			0.004,
			0.003,
			0.002,
			0.003,
			0.003,
			0.003,
			0.004,
			0.005,
			0.006,
			0.006,
			0.007,
			0.009,
			0.011,
			0.014,
			0.016,
			0.015,
			0.016,
			0.018,
			0.019,
			0.019,
			0.021,
			0.023,
			0.025,
			0.029,
			0.035,
			0.039,
			0.044,
			0.048,
			0.053,
			0.059,
			0.066,
			0.073,
			0.079,
			0.086,
			0.093,
			0.099,
			0.105,
			0.11,
			0.114,
			0.12,
			0.126,
			0.133,
			0.139,
			0.145,
			0.152,
			0.158,
			0.164,
			0.173,
			0.182,
			0.19,
			0.199,
			0.208,
			0.215,
			0.223,
			0.231,
			0.238,
			0.243,
			0.248,
			0.254,
			0.259,
			0.264,
			0.269,
			0.273,
			0.278,
			0.282,
			0.287,
			0.291,
			0.295,
			0.299,
			0.302,
			0.304,
			0.307,
			0.311,
			0.314,
			0.316,
			0.319,
			0.323,
			0.326,
			0.328,
			0.331,
			0.333,
			0.335,
			0.339,
			0.342,
			0.345,
			0.349,
			0.354,
			0.358,
			0.362,
			0.365,
			0.369,
			0.371,
			0.373,
			0.377,
			0.381,
			0.383,
			0.384,
			0.387,
			0.39,
			0.392,
			0.392,
			0.395,
			0.4,
			0.403,
			0.403,
			0.405,
			0.407,
			0.41,
			0.412,
			0.413,
			0.413,
			0.414,
			0.417,
			0.418,
			0.42,
			0.423,
			0.424,
			0.425,
			0.428,
			0.43,
			0.432,
			0.435,
			0.439,
			0.442,
			0.445,
			0.448,
			0.451,
			0.451,
			0.453,
			0.456,
			0.458,
			0.459,
			0.461,
			0.463,
			0.465,
			0.466,
			0.468,
			0.47,
			0.472,
			0.474,
			0.473,
			0.474,
			0.477,
			0.478,
			0.477,
			0.479,
			0.481,
			0.48,
			0.48,
			0.482,
			0.485,
			0.485,
			0.485,
			0.486,
			0.487,
			0.489,
			0.491,
			0.492,
			0.493,
			0.496,
			0.499,
			0.501,
			0.502,
			0.504,
			0.506,
			0.507,
			0.509,
			0.51,
			0.512,
			0.514,
			0.515,
			0.516,
			0.517,
			0.518,
			0.52,
			0.521,
			0.523,
			0.523,
			0.523,
			0.524,
			0.525,
			0.527,
			0.527,
			0.528,
			0.53,
			0.531,
			0.532,
			0.532,
			0.532,
			0.534,
			0.536,
			0.537,
			0.538,
			0.539,
			0.54,
			0.54,
			0.543,
			0.546,
			0.549,
			0.548,
			0.548,
			0.548,
			0.55,
			0.552,
			0.553,
			0.553,
			0.554,
			0.556,
			0.556,
			0.556,
			0.559,
			0.561,
			0.562,
			0.562,
			0.563,
			0.563,
			0.564,
			0.566,
			0.567,
			0.567,
			0.568,
			0.571,
			0.571,
			0.571,
			0.572,
			0.573,
			0.573,
			0.574,
			0.576,
			0.578,
			0.579,
			0.581,
			0.582,
			0.584,
			0.585,
			0.586,
			0.587,
			0.589,
			0.589,
			0.589,
			0.59,
			0.59,
			0.589,
			0.59,
			0.592,
			0.594,
			0.593,
			0.593,
			0.594,
			0.593,
			0.592,
			0.593,
			0.593,
			0.592,
			0.593,
			0.594,
			0.592,
			0.592,
			0.594,
			0.595,
			0.593,
			0.592,
			0.594,
			0.595,
			0.596,
			0.597,
			0.598,
			0.599,
			0.6,
			0.602,
			0.604,
			0.606,
			0.607,
			0.607,
			0.607,
			0.608,
			0.61,
			0.61,
			0.611,
			0.612,
			0.614,
			0.614,
			0.613,
			0.614,
			0.615,
			0.615,
			0.614,
			0.614,
			0.614,
			0.613,
			0.614,
			0.615,
			0.617,
			0.618,
			0.617,
			0.616,
			0.615,
			0.616,
			0.618,
			0.618,
			0.618,
			0.619,
			0.622,
			0.623,
			0.624,
			0.627,
			0.629,
			0.63,
			0.631,
			0.632,
			0.633,
			0.633,
			0.634,
			0.634,
			0.635,
			0.636,
			0.637,
			0.636,
			0.637,
			0.638,
			0.638,
			0.637,
			0.637,
			0.638,
			0.638,
			0.638,
			0.639,
			0.64,
			0.639,
			0.639,
			0.638,
			0.639,
			0.64,
			0.641,
			0.64,
			0.641,
			0.643,
			0.643,
			0.644,
			0.647,
			0.65,
			0.651,
			0.652,
			0.653,
			0.653,
			0.655,
			0.656,
			0.656,
			0.656,
			0.658,
			0.658,
			0.658,
			0.658,
			0.66,
			0.66,
			0.66,
			0.661,
			0.661,
			0.66,
			0.66,
			0.66,
			0.66,
			0.662,
			0.663,
			0.662,
			0.662,
			0.662,
			0.661,
			0.661,
			0.661,
			0.663,
			0.664,
			0.664,
			0.664,
			0.663,
			0.664,
			0.666,
			0.667,
			0.668,
			0.669,
			0.669,
			0.668,
			0.667,
			0.669,
			0.669,
			0.668,
			0.668,
			0.669,
			0.67,
			0.671,
			0.671,
			0.67,
			0.67,
			0.671,
			0.672,
			0.67,
			0.67,
			0.67,
			0.67,
			0.669,
			0.67,
			0.671,
			0.67,
			0.67,
			0.67,
			0.67,
			0.67,
			0.672,
			0.674,
			0.675,
			0.677,
			0.679,
			0.68,
			0.681,
			0.682,
			0.684,
			0.684,
			0.685,
			0.686,
			0.687,
			0.688,
			0.689,
			0.69,
			0.69,
			0.69,
			0.691,
			0.692,
			0.693,
			0.692,
			0.69,
			0.692,
			0.693,
			0.692,
			0.69,
			0.692,
			0.694,
			0.695,
			0.694,
			0.693,
			0.692,
			0.692,
			0.693,
			0.693,
			0.693,
			0.695,
			0.696,
			0.696,
			0.697,
			0.7,
			0.701,
			0.701,
			0.701,
			0.702,
			0.702,
			0.702,
			0.703,
			0.703,
			0.703,
			0.704,
			0.705,
			0.706,
			0.706,
			0.707,
			0.707,
			0.706,
			0.705,
			0.706,
			0.707,
			0.707,
			0.707,
			0.708,
			0.709,
			0.708,
			0.707,
			0.709,
			0.71,
			0.709,
			0.707,
			0.707,
			0.708,
			0.707,
			0.708,
			0.711,
			0.714,
			0.712,
			0.711,
			0.712,
			0.713,
			0.713,
			0.712,
			0.712,
			0.712,
			0.712,
			0.711,
			0.709,
			0.71,
			0.711,
			0.711,
			0.709,
			0.708,
			0.708,
			0.707,
			0.705,
			0.705,
			0.705,
			0.705,
			0.705,
			0.704,
			0.703,
			0.702,
			0.701,
			0.7,
			0.699,
			0.7,
			0.7,
			0.699,
			0.699,
			0.7,
			0.701,
			0.701,
			0.702,
			0.703,
			0.705,
			0.705,
			0.705,
			0.704,
			0.705,
			0.704,
			0.704,
			0.704,
			0.705,
			0.705,
			0.704,
			0.702,
			0.702,
			0.701,
			0.701,
			0.699,
			0.699,
			0.698,
			0.698,
			0.697,
			0.697,
			0.698,
			0.697,
			0.695,
			0.694,
			0.693,
			0.692,
			0.691,
			0.69,
			0.69,
			0.691,
			0.692,
			0.692,
			0.69,
			0.69,
			0.691,
			0.691,
			0.692,
			0.691,
			0.69,
			0.687,
			0.683,
			0.68,
			0.679,
			0.678,
			0.673,
			0.667,
			0.663,
			0.659,
			0.654,
			0.648,
			0.642,
			0.638,
			0.634,
			0.629,
			0.626,
			0.623,
			0.62,
			0.615,
			0.61,
			0.605,
			0.6,
			0.594,
			0.588,
			0.583,
			0.578,
			0.571,
			0.564,
			0.56,
			0.555,
			0.551,
			0.547,
			0.543,
			0.538,
			0.532,
			0.524,
			0.515,
			0.506,
			0.497,
			0.487,
			0.477,
			0.468,
			0.456,
			0.442,
			0.428,
			0.414,
			0.4,
			0.388,
			0.376,
			0.365,
			0.356,
			0.346,
			0.336,
			0.324,
			0.312,
			0.3,
			0.287,
			0.274,
			0.262,
			0.25,
			0.236,
			0.222,
			0.208,
			0.196,
			0.184,
			0.172,
			0.161,
			0.15,
			0.141,
			0.133,
			0.125,
			0.117,
			0.111,
			0.107,
			0.101,
			0.095,
			0.092,
			0.09,
			0.086,
			0.082,
			0.08,
			0.077,
			0.074,
			0.071,
			0.069,
			0.069,
			0.067,
			0.066,
			0.064,
			0.063,
			0.062,
			0.062,
			0.061,
			0.059,
			0.058,
			0.057,
			0.055,
			0.054,
			0.055,
			0.055,
			0.054,
			0.053,
			0.054,
			0.054,
			0.053,
			0.051,
			0.051,
			0.05,
			0.049,
			0.047,
			0.047,
			0.047,
			0.046,
			0.043,
			0.041,
			0.041,
			0.04,
			0.037,
			0.035,
			0.033,
			0.032,
			0.03,
			0.028,
			0.028,
			0.027,
			0.027,
			0.024,
			0.022,
			0.021,
			0.019,
			0.017,
			0.015,
			0.014,
			0.014,
			0.012,
			0.011,
			0.01,
			0.009,
			0.009,
			0.009,
			0.008,
			0.007,
			0.007,
			0.006,
			0.006,
			0.006,
			0.006,
			0.006,
			0.006,
			0.005,
			0.005,
			0.006,
			0.005,
			0.005,
			0.005,
			0.005,
			0.003,
			0.003,
			0.004,
			0.005,
			0.004,
			0.004,
			0.005,
			0.006,
			0.005,
			0.004,
			0.003,
			0.004,
			0.004,
			0.004,
			0.003,
			0.003,
			0.005,
			0.005,
			0.004,
			0.004,
			0.005,
			0.004,
			0.004,
			0.004,
			0.004,
			0.004,
			0.004,
			0.004,
			0.004,
			0.004,
			0.004,
			0.003,
			0.003,
			0.003,
			0.004,
			0.004,
			0.003,
			0.003,
			0.003,
			0.002,
			0.002,
			0.003,
			0.005,
			0.005,
			0.004,
			0.004,
			0.003,
			0.003,
			0.003,
			0.003,
			0.004,
			0.004,
			0.004,
			0.003,
			0.003,
			0.004,
			0.004,
			0.004,
			0.003,
			0.003,
			0.002,
			0.002,
			0.003,
			0.002,
			0.003,
			0.004,
			0.004,
			0.003,
			0.003,
			0.003,
			0.003,
			0.004,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.004,
			0.004,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.004,
			0.003,
			0.003,
			0.003,
			0.003,
			0.002,
			0,
			0.002,
			0.004,
			0.003,
			0.002,
			0.002,
			0.003,
			0.004,
			0.003,
			0.001,
			0.001,
			0.003,
			0.004,
			0.003,
			0.002,
			0.003,
			0.002,
			0.002,
			0.003,
			0.004,
			0.002,
			0.001,
			0.003,
			0.004,
			0.003,
			0.002,
			0.002,
			0.002,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.002,
			0.002,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.004,
			0.003,
			0.003,
			0.004,
			0.003,
			0.001,
			0.002,
			0.004,
			0.005,
			0.003,
			0.002,
			0.003,
			0.004,
			0.004,
			0.003,
			0.002,
			0.002,
			0.003,
			0.003,
			0.003,
			0.004,
			0.004,
			0.003,
			0.003,
			0.005,
			0.005,
			0.003,
			0.003,
			0.003,
			0.004,
			0.004,
			0.004,
			0.003,
			0.003,
			0.004,
			0.004,
			0.003,
			0.003,
			0.004,
			0.004,
			0.004,
			0.004,
			0.004,
			0.003,
			0.003,
			0.004,
			0.004,
			0.005,
			0.005,
			0.004,
			0.004,
			0.004,
			0.003,
			0.002,
			0.003,
			0.004,
			0.004,
			0.003,
			0.004,
			0.004,
			0.003,
			0.003,
			0.002,
			0.002,
			0.003,
			0.004,
			0.002,
			0.001,
			0.003,
			0.004,
			0.003,
			0.003,
			0.004,
			0.004,
			0.003,
			0.002,
			0.002,
			0.002,
			0.003,
			0.003,
			0.002,
			0.001,
			0.002,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.002,
			0.002,
			0.001,
			0.001,
			0.001,
			0.001,
			0.002,
			0.003,
			0.002,
			0.001,
			0.002,
			0.002,
			0.001,
			0,
			0.002,
			0.003,
			0.002,
			0.002,
			0.002,
			0.003,
			0.003,
			0.003,
			0.003,
			0.002,
			0.002,
			0.002,
			0.002,
			0.001,
			0.002,
			0.002,
			0.002,
			0.002,
			0.003,
			0.002,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.002,
			0.003,
			0.003,
			0.003,
			0.003,
			0.002,
			0.002,
			0.003,
			0.003,
			0.002,
			0.002,
			0.001,
			0.001,
			0.002,
			0.003,
			0.003,
			0.003,
			0.003,
			0.001,
			0,
			0.001,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.003,
			0.003,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.003,
			0.002,
			0.001,
			0.002,
			0.003,
			0.002,
			0.003,
			0.003,
			0.003,
			0.002,
			0.002,
			0.003,
			0.003,
			0.003,
			0.004,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.004,
			0.004,
			0.004,
			0.003,
			0.003,
			0.003,
			0.003,
			0.004,
			0.005,
			0.004,
			0.004,
			0.004,
			0.002,
			0.002,
			0.004,
			0.005,
			0.004,
			0.003,
			0.003,
			0.003,
			0.004,
			0.004,
			0.004,
			0.004,
			0.003,
			0.003,
			0.002,
			0.002,
			0.003,
			0.004,
			0.004,
			0.003,
			0.003,
			0.003,
			0.004,
			0.003,
			0.003,
			0.003,
			0.004,
			0.003,
			0.002,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.003,
			0.004,
			0.004,
			0.003,
			0.003,
			0.002,
			0.003,
			0.004,
			0.004,
			0.003,
			0.002,
			0.004,
			0.003,
			0.002,
			0.003,
			0.004,
			0.004,
			0.002,
			0.003,
			0.003,
			0.002,
			0.003,
			0.003,
			0.002,
			0.002,
			0.003,
			0.003,
			0.002,
			0.003,
			0.003,
			0.002,
			0.003,
			0.003,
			0.002,
			0.002,
			0.003,
			0.003,
			0.003,
			0.004,
			0.003,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.003,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.003,
			0.004,
			0.002,
			0.001,
			0.002,
			0.001,
			0,
			0.001,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.003,
			0.003,
			0.002,
			0.001,
			0.001,
			0.003,
			0.003,
			0.002,
			0.001,
			0.002,
			0.003,
			0.002,
			0.003,
			0.003,
			0.002,
			0.002,
			0.003,
			0.004,
			0.002,
			0.001,
			0.002,
			0.003,
			0.003,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.002,
			0.003,
			0.003,
			0.003,
			0.002,
			0.003,
			0.002,
			0.002,
			0.002};
	private final double mCo2Max = 0.932;
	private final double mCo2Min = 0;
	// Current Signal
	private int SIGNAL_TYPE;
	
	/**
	 * Constructor.
	 * 
	 * @param fs - Sampling Frequency.
	 * @param bits - Resolution.
	 * @param totalSamples - Amount of samples to generate.
	 */
	AdcChannel(double fs, int bits, int totalSamples, int totalChannels) {
		mTs = 1/fs;
		mBits = bits;
		mTotalSteps = Math.pow(2, mBits);
		mTotalSamples = totalSamples;
		mTotalChannels = totalChannels;
		mSamples = new short[totalSamples];
		mDelay = ((long)(1000*totalSamples*mTs/totalChannels));
	}
	
	/**
	 * Populates the mSamples array and waits mDelay to return it.
	 * @return The array of generated samples.
	 */
	public synchronized short[] getSamples() {	
		for(int i = 0; i < mTotalSamples; i++) mSamples[i] = generateSample();
		try { Thread.sleep(mDelay); } catch (InterruptedException e1) {}
		return mSamples;
	}
	
	/**
	 * Generates a sample of SIGNAL_TYPE.
	 * @return The generated sample.
	 */
	// Selector de señal
	private synchronized short generateSample() {
		n++;
		
		switch(SIGNAL_TYPE) {
		
			case SIGNAL_SINE:
				mCurrentSample = (short) ((mA*Math.sin(2*Math.PI*mF0*n*mTs) + mOffset) / mStep);
				break;
		
			case SIGNAL_SAWTOOTH:
				if(n*mTs < 2*mA/mSawtoothSlope) mCurrentSample = (short) ((-mF0*n*mTs + 2*mOffset) / mStep);
				if(n*mTs >= 2*mA/mF0) n = 0;
				break;
					
			case SIGNAL_SQUARE:
				double mT0 = 1 / mF0;
				if(n*mTs < mT0/2) mCurrentSample = (short) (((2*mA) + mOffset - 1)  / mStep);
				if(n*mTs > mT0/2) mCurrentSample = (short) ((mOffset - 1)  / mStep);
				if(n*mTs > mT0) n = 0; 				
				break;
				
			case SIGNAL_SEQUENCE:
				if(n == mTotalSteps) n = 0;
				mCurrentSample = (short) n;
				break;
				
			case SIGNAL_EKG:
				if(n >= mEkgSignal.length/mSampling) n = 0;
				mCurrentSample = mEkgSignal[(int) (n*mSampling)];
				//mCurrentSample = mEkgBuffer.getSample((int) (n*mSampling*4));
				// 1000*mTs times Sampling to to adjust to current mFs
				//mCurrentSample = mEkgBuffer.getSample((int) (n*mSampling*(1000*mTs)));
				break;
				
			case SIGNAL_PRESSURE:
				if(n == mPressureSignal.length) n = 0;
				mCurrentSample = (short) ((mPressureSignal[n] - mPressureMin) / ((mPressureMax-mPressureMin)*mStep));
				
			case SIGNAL_CO2:
				if(n == mCo2Signal.length) n = 0;
				mCurrentSample = (short) (mCo2Signal[n] - mCo2Min / ((mCo2Max-mCo2Min)*mStep));
		}
			
		return mCurrentSample;
		
	}
	
	/**
	 * Sets the Signal Frequency.
	 * @param f0 - Signal Frequency.
	 */
	public void setF0(double f0) {
		mF0 = f0;
	}
	
	/**
	 * Sets the Signal Amplitude.
	 * @param amplitude - Signal Amplitude.
	 */
	public void setAmplitude(double amplitude) {
		mA = amplitude;
		mStep = 2 * amplitude / mTotalSteps;
	}

	/**
	 * Sets the Signal Offset.
	 * @param offset - Signal Offset.
	 */
	public void setOffset(double offset) {
		mOffset = 1 + (offset*0.025);
	}
	
	/**
	 * Sets the initial offset.
	 * @param offset
	 */
	public void setInitialOffset(double offset) {
		mOffset = offset;
	}
	
	/**
	 * Sets the Signal Type.
	 * @param signalCode - 1 = Sine, 2 = Sawtooth, 3 = Square, 4 = Incrementing Sequence, 5 = EKG, 6 = Pressure.
	 */
	public void setSignalType(int signalCode) {
		
		SIGNAL_TYPE = signalCode;
		n = 0;
		
		switch(signalCode) {
			case SIGNAL_SINE:
				setInitialOffset(1);
				setF0(1);
				setAmplitude(1);
				break;
		
			case SIGNAL_SAWTOOTH:
				setInitialOffset(1);
				setF0(1);
				setAmplitude(1);
				break;
					
			case SIGNAL_SQUARE:	
				setInitialOffset(1);
				setF0(1);
				setAmplitude(1);
				break;
				
			case SIGNAL_SEQUENCE:
				break;
				
			case SIGNAL_EKG:
				//mEkgBuffer = new CircularBuffer(mEkgSignal);
				// Signal is originally 120 bpm
				setF0(2);
				break;
				
			case SIGNAL_PRESSURE:
				mStep = 1 / mTotalSteps;
				break;
		}
	}
	
	/**
	 * Sets the delay time between each batch of samples.
	 * @param delay (in seconds).
	 */
	public void setDelay(double delay) {
		
		if(SIGNAL_TYPE == SIGNAL_EKG) {
			int length = (int) (mEkgSignal.length / mSampling);
			double time = length * mTs;
			long globalDelay = (long) (1000*mTotalSamples*mTs/mTotalChannels);
			mDelay = (long) (((2)/delay)*globalDelay*mTotalChannels - (mTotalChannels-1)*globalDelay);
			if(mDelay < 0) mDelay = globalDelay;
		}
	}
	
	/**
	 * Gets the Signal Code.
	 */
	public int getSignalCode() {
		return SIGNAL_TYPE;
	}
	
	/**
	 * Gets the Signal Frequency.
	 */
	public double getF0() {
		return mF0;
	}
	
	/**
	 * Gets the Signal Offset.
	 */
	public double getOffset() {
		return mOffset;
	}
	
	/**
	 * Gets the Signal Amplitude.
	 */
	public double getAmplitude() {
		return mA;
	}

	/**
	 * Gets the Ekg Signal.
	 */
	public short[] getEkgSignal() {
		return mEkgSignal;
	}

}// AdcChannel
